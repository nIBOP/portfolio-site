---
slug: monitoring
title: Мониторинг загрузки транспортной инфраструктуры Краснодарского края
summary: Очистка и сбор данных, Excel, Superset
date: 2025-10-21
specialization: data-analytics
---

## Контекст проекта

**Заказчик:** Министерство Транспорта РФ

**Период:** С декабря 2024 по март 2025

**Проблема:** В связи с масштабными строительными работами на Черноморском побережье Краснодарского края необходимо было оценить пропускную способность железнодорожной инфраструктуры и выявить риски дефицита мощностей для доставки стройматериалов и пассажиров. Критическая сложность — полное отсутствие централизованных данных на старте проекта.

## Задачи

- Оценить максимальную пропускную способность ЖД-инфраструктуры региона
- Спрогнозировать объемы грузоперевозок для строительных проектов (2025-2033)
- Учесть пассажиропоток с учетом реконструкции аэропорта
- Выявить узкие места в логистической цепочке
- Разработать систему мониторинга баланса загрузки

## Вызовы

### Сбор данных из разрозненных источников

- **Инфраструктурные данные:** ручной анализ сотен электронных писем от руководителей РЖД для поиска информации о максимальной длине составов, количестве пар поездов, вместимости грузовых дворов
- **Согласование с РЖД:** потребовалось 5 официальных запросов и 2 встречи на уровне заместителя директора для верификации данных
- **Проектно-сметная документация:** ручной сбор требований по стройматериалам из разрозненных документов, включая самостоятельный расчет объемов бетонной смеси для объектов с просроченными сроками
- **Ограничения местной администрации:** запрет на внутригородские грузоперевозки и ограничения на использование старых внегородских дорог

### Работа с неполными данными

- Точность первичных проектов по потреблению материалов составляла ~20% (выяснилось post-factum через полгода)
- Пассажиропоток: отсутствие прогнозов, необходимость учета перенаправления авиапассажиров на ЖД-транспорт

## Подход и методология

### Этап 1: Сбор и структурирование данных (недели 1-2)

1. **Инфраструктурный анализ:**
   - Ручной парсинг корреспонденции за несколько лет
   - Выявление ограничений: максимальная длина составов, пропускная способность веток, вместимость грузовых дворов
   - Построение модели функционирования инфраструктуры

2. **Грузоперевозки:**
   - Сбор проектно-сметной документации по всем стройобъектам
   - Создание унифицированного датасета: **106 столбцов**, временной горизонт 2025-2033
   - Приведение данных к единой номенклатуре: тонны → вагоны → поезда
   - Фильтрация нестандартных грузов (<0.001% от общего объема)

3. **Пассажиропоток:**
   - Получение статистических справок РЖД (номер поезда, количество мест, количество пассажиров)
   - Разработка Python-парсера для обработки данных
   - Когортный анализ по основным направлениям движения
   - Оценка свободных мест и резервов провозной способности

### Этап 2: Быстрый прототип в Excel (неделя 2)

**Цель:** предоставить предварительную аналитику для первого отчета

- Помесячные сводные таблицы по материалам (тонны/вагоны/поезда)
- Визуализация: графики по типам материалов, помесячная нагрузка, динамика
- Расчет баланса загрузки инфраструктуры

### Этап 3: Итоговое решение (месяц 1-2)

1. **Определение пропускной способности:**
   - Установлено конкретное ограничение: **X вагонов и Y поездов в день**
   - Учтена нагрузка на грузовые дворы и скорость вывоза материалов автотранспортом

2. **Транспортная схема:**
   - Привлечение специалиста для разработки логистической схемы доставки
   - Окончательное сведение направлений грузоперевозок
   - Финализация цифр по потребным материалам

3. **Вывод по пассажирам:**
   - Выявлен достаточный запас провозной способности
   - Принято решение оперативного управления совместно с РЖД (без жестких планов)

### Этап 4: Автоматизация и дашборд

**Инфраструктура:**
- **Сбор данных:** Яндекс.Формы с интеграцией по API
- **Хранение:** PostgreSQL
- **Визуализация:** Apache Superset

**Функционал:**
- Автоматическое обновление данных от подрядчиков через стандартизированную форму
- Интерактивные дашборды для руководства
- Мобильный доступ для презентаций на совещаниях (авторизация через веб-интерфейс)

## Используемые технологии

| Инструмент | Назначение |
|------------|-----------|
| **Microsoft Excel** | Первичный анализ, сводные таблицы, прототипирование дашбордов |
| **Python** | Парсинг статистики пассажиропотока, автоматизация обработки данных |
| **PostgreSQL** | Централизованное хранилище данных |
| **Apache Superset** | BI-платформа для визуализации и дашбордов |
| **Яндекс.Формы + API** | Стандартизированный сбор данных от подрядчиков |

## Ключевые метрики и результаты

### Количественные результаты

- Проанализировано **100+ писем** от РЖД за несколько лет
- Собраны данные по **106 столбцам** на период 2025-2033
- Обработана статистика по пассажиропотоку за несколько лет (тысячи рейсов)
- Создана модель с конкретными ограничениями пропускной способности (X вагонов/Y поездов в день)

### Качественные результаты

✅ **Выявлены узкие места** в логистической цепочке региона

✅ **Построена прогнозная модель** загрузки инфраструктуры на 8 лет вперед

✅ **Автоматизирован процесс** сбора и обновления данных от подрядчиков

✅ **Создан инструмент** для оперативного принятия решений руководством на совещаниях

✅ **Определена стратегия** оперативного управления пассажиропотоком

### Бизнес-ценность

- Предотвращение логистического коллапса при масштабном строительстве
- Обоснованное планирование распределения грузопотоков
- Прозрачность для всех участников (Минтранс, РЖД, региональные власти, подрядчики)
- Основа для принятия управленческих решений на уровне федерального министерства

## Особенности реализации

### Работа с заинтересованными сторонами

- Многоуровневые согласования с РЖД (от отделов до заместителя директора)
- Взаимодействие с региональной администрацией по ограничениям транспортной сети
- Координация с подрядчиками по стандартам предоставления данных

### Работа в условиях неопределенности

- Отсутствие начальных данных → проактивный поиск в архивах
- Низкая точность проектных данных → создание запаса прочности в модели
- Жесткие дедлайны → поэтапная поставка результатов (Excel → полноценная BI-система)

## Извлеченные уроки

1. **Важность быстрого MVP:** Excel-прототип на 2-й неделе позволил показать прогресс и получить обратную связь
2. **Проактивный сбор данных:** успех проекта зависел от настойчивости в получении информации из закрытых источников
3. **Верификация данных:** критически важно проверять точность входных данных (а лучше сразу пытаться предостмотреть, что что-то пойдет не так)
4. **Гибкость решений:** пассажиропоток решили управлять оперативно, а не планировать жестко — правильный выбор при высокой неопределенности

## Визуальные материалы

Так получилось, что сейчас, когда я решил это все описать уже был демонтирован постгрес и дашборды мы делаем в Datalens. А скринов толком и не было нигде, не принято скриншотить особо, когда работаешь с секреткой. Но вот что смог найти в переписке с коллегами.

![Скриншот запроса в SuperSet](/img/superset-query.jpg)

Здесь особо внимательные могут заметить, что почему-то запрос использует структуру JSON, в целом поэтому скриншот и сохранился, пробовали использовать JSONB хранение в Postgre, позже отказались в этом проекте, но использовали в другом.

![Скриншот отчета из Экселя](/img/excel-krim-1.png)

Вот как раз первый отчет

![Скриншот сводной таблицы из Экселя](/img/excel-krim-pivot.png)

Тоже первый, сводные таблицы по годам, но там еще данные не все были внесены, поэтому даже не замазываю.

![Скриншот таблицы по Грузам](/img/excel-krim-cargo.png)

Здесь данные подменены на другие

---

**Навыки, продемонстрированные в проекте:**
- Сбор и структурирование данных из разрозненных источников
- Python (парсинг и автоматизация)
- SQL и работа с PostgreSQL
- Excel (сводные таблицы, визуализация, прототипирование)
- Apache Superset (BI-дашборды)
- Работа с API (интеграция Яндекс.Форм)
- Проектное управление в условиях неопределенности
- Коммуникация с государственными структурами и крупными компаниями

---

## Как это было на самом деле

Когда Министерство Транспорта объявило о необходимости оценить инфраструктуру Черноморского побережья в связи с массовым строительством, руководство сказало просто: "Попробуй что-то выяснить". Никаких данных. Вообще. Просто идея и дедлайн.

### Археология в почте

Начал с того, что в ручную перелопатил сотню старых писем разных руководителей РЖД. Искал вообще любые упоминания ограничений инфраструктуры и средних показателей перевозок. Параллельно слал запросы всем коллегам, которые могли бы что-то предоставить.

За неделю в этих письмах нашёл крупицы: максимальная длина составов, количество пар поездов по разным путевым веткам, вместимость грузовых дворов и так далее. 

Написал официальный запрос в РЖД. Ответ: "Обязательно всё когда-нибудь дадим". Спойлер: понадобилось ещё 5 запросов и две встречи нашего руководства с их, вплоть до заместителя директора РЖД, чтобы получить простое подтверждение, что всё найденное мной — верно.

### Построение модели

В итоге смогли собрать картину того, как именно работает инфраструктура, и выделили узкие места. Получили конкретное ограничение: **X вагонов и Y поездов в день** с учётом нагрузки на грузовые дворы и скорости вывоза материалов автотранспортом.

Дальше надо было выяснить, на какие строительные мероприятия сколько чего нужно привезти, а главное — как и когда. Опять копание в разных проектно-сметных документах. Количество бетонной смеси для одного объекта пришлось считать самому, потому что от исполнителя получил: "Ещё не дошли до этого этапа". При том что сроки были просрочены ещё в день начала работ.

Данные привели к единообразному виду — получился датасет с **106 столбцами** на период с 2025 по 2033 год. Запросили ещё прогнозы по потреблению товаров от регионального правительства.

### Быстрый прототип на Excel

К концу второй недели надо было отчитаться хоть о какой-то предварительной аналитике. Взял всё это полотно данных и сделал помесячные сводные таблицы по необходимым материалам в формате тонны/вагоны/поезда. 

Некоторые грузы не укладывались в эту условную номенклатуру, но их доля составляла меньше 0,001% от общего объёма, и их выброс не сильно уменьшал точность. Подготовил несколько графиков по типам материалов, помесячной нагрузке и прочему.

### Пассажиропоток

С пассажирами было ещё грустнее. Грузы хотя бы расписаны в проектно-сметной документации, а вот пассажиры — совсем непонятная история. Плюс на эти же годы выпадала реконструкция одной из двух ВПП местного аэропорта, и руководство сказало принять, что эти пассажиры тоже поедут по железной дороге.

Получили от РЖД огромные статистические справки о проехавших поездах в формате: номер поезда, количество мест, количество пассажиров. Написал на Python парсер, который собрал статистику по проезду всех этих пассажиров. Определили когорты в виде основных направлений движения, получили достаточно стабильное среднее по количеству пассажиров и свободных мест.

Параллельно слал запросы в РЖД, чтобы узнать, сколько у них поездов в резерве и смогут ли их поставить, пытался понять, сколько какая станция переваривает поездов в день и где узкие места.

По пассажиропотоку работы было проведено, возможно, даже больше, но где-то через месяц после начала исследования пришли к выводу: по пассажирам существует вполне весомый запас. Примерно подсчитали его и решили довериться РЖД, которые и так настаивали, что будут всё оперативно решать, а не планировать заранее.

### Грузы: финальный босс

С грузами всё становилось сложнее. Местная администрация сказала, что не хочет, чтобы материалы возили внутри города, а дороги вне города старые и по ним грузовикам нельзя. "Думайте сами, где вам всё это везти".

Тут привлёк товарища, который сделал транспортную схему. Заодно я окончательно свёл, какие грузы откуда едут, и уточнил все цифры по потребным материалам.

По секрету скажу: через полгода оказалось, что точность первичных проектов по потреблению материалов была в районе **20%**. На вопрос "почему так?" начальник отдела снабжения одной госкомпании ответил: "Ну я же писал в письмах 'предварительно'". На секундочку, стройка тогда уже шла полным ходом.

### Автоматизация

После кучи правок сделали отчёт в Excel, выработали стандарт по обмену данными и на его основе создали форму в Яндекс.Формах для обновления данных по материалам. Форма по API отправляла всё в PostgreSQL, а оттуда данные попадали в Apache Superset.

Открыли сервак с Superset, и наше руководство ездило на совещания, открывало его, авторизовывалось и показывало графики. Работало отлично.

### Эпилог

К сожалению, когда я решил всё это описать, у нас уже не осталось ни того PostgreSQL, ни Superset — у нас очень мало инфраструктуры, и вот так получилось. Но в целом там были несложные графики, так что думаю, это не принципиально. А вот какие-то Excel-таблицы остались, поэтому есть скрины из них и, возможно, пара скринов из Superset.

Проект научил главному: в аналитике половина работы — это не запросы к базе данных, а запросы к людям. И иногда найти нужную цифру в старом письме важнее, чем написать идеальный SQL.
